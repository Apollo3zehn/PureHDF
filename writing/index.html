<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Writing | PureHDF </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Writing | PureHDF ">
      
      <link rel="icon" href="../images/icon.png">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      
      
      
      <meta name="docfx:docurl" content="https://github.com/Apollo3zehn/PureHDF/blob/master/doc/writing/index.md/#L1">
  </head>

  <script type="module">
    import options from './../public/main.js'
    import { init } from './../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/icon.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="writing">Writing</h1>

<p>PureHDF can easily create new files, as described in more detail below. However, <strong>editing existing</strong> files is outside the scope of PureHDF.</p>
<p>To get started, first create a new <code>H5File</code> instance:</p>
<pre><code class="lang-cs">var file = new H5File();
</code></pre>
<p>A <code>H5File</code> derives from the <code>H5Group</code> type because it represents the root group. <code>H5Group</code> implements the <code>IDictionary</code> interface, where the keys represent the links in an HDF5 file and the value determines the type of the link: either it is another <code>H5Group</code> or a <code>H5Dataset</code>.</p>
<p>You can create an empty group like this:</p>
<pre><code class="lang-cs">var group = new H5Group();
</code></pre>
<p>If the group should have some datasets, just add them using the dictionary collection initializer - just like with a normal dictionary:</p>
<pre><code class="lang-cs">var group = new H5Group()
{
    [&quot;numerical-dataset&quot;] = new double[] { 2.0, 3.1, 4.2 },
    [&quot;string-dataset&quot;] = new string[] { &quot;One&quot;, &quot;Two&quot;, &quot;Three&quot; }
};
</code></pre>
<p>Datasets and attributes can both be created either by instantiating their specific class (<code>H5Dataset</code>, <code>H5Attribute</code>) or by just providing some kind of data. This data can be nearly anything: arrays, scalars, numerical values, strings, anonymous types, enums, complex objects, structs, bool values, etc. However, whenever you want to provide more details like the dimensionality of the attribute or dataset, the chunk layout or the filters to be applied to a dataset, you need to instantiate the appropriate class.</p>
<p>But first, let's see how to add attributes. Attributes cannot be added directly using the dictionary collection initializer because that is only for datasets. However, every <code>H5Group</code> has an <code>Attribute</code> property which accepts our attributes:</p>
<pre><code class="lang-cs">var group = new H5Group()
{
    Attributes = new()
    {
        [&quot;numerical-attribute&quot;] = new double[] { 2.0, 3.1, 4.2 },
        [&quot;string-attribute&quot;] = new string[] { &quot;One&quot;, &quot;Two&quot;, &quot;Three&quot; }
    }
};
</code></pre>
<p>The full example with the root group, a subgroup, two datasets and two attributes looks like this:</p>
<pre><code class="lang-cs">using PureHDF;

var file = new H5File()
{
    [&quot;my-group&quot;] = new H5Group()
    {
        [&quot;numerical-dataset&quot;] = new double[] { 2.0, 3.1, 4.2 },
        [&quot;string-dataset&quot;] = new string[] { &quot;One&quot;, &quot;Two&quot;, &quot;Three&quot; },
        Attributes = new()
        {
            [&quot;numerical-attribute&quot;] = new double[] { 2.0, 3.1, 4.2 },
            [&quot;string-attribute&quot;] = new string[] { &quot;One&quot;, &quot;Two&quot;, &quot;Three&quot; }
        }
    }
};
</code></pre>
<p>The last step is to write the defined file to the drive:</p>
<pre><code class="lang-cs">file.Write(&quot;path/to/file.h5&quot;);
</code></pre>
<h2 id="deferred-writing">Deferred writing</h2>
<p>You may want to write data at a later point in time (for instance if the data is not available yet) and for this scenario PureHDF offers a slightly different API. The following example shows how to use the <code>H5File.BeginWrite(...)</code> method to get a writer which allows you to write data to the dataset one or multiple times until the writer instance is being disposed.</p>
<pre><code class="lang-cs">var data = Enumerable.Range(0, 100).ToArray();
var dataset = new H5Dataset&lt;int[]&gt;(fileDims: new ulong[] { (ulong)data.Length });

var file = new H5File
{
    [&quot;my-dataset&quot;] = dataset
};

using var writer = file.BeginWrite(&quot;path/to/file.h5&quot;);
writer.Write(dataset, data);
</code></pre>
<p>You probably do not want to write all data at once but in chunks. To do so, make use of selections to select the proper slice of the dataset to write to. Create a selection and then pass it to the write method (the element count of the selection must match the element count of the data):</p>
<pre><code class="lang-cs">using PureHDF.Selections;

var fileSelection = new HyperslabSelection(start: 2, block: 5);
writer.Write(dataset, data, fileSelection: fileSelection);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>See <a href="../reading/slicing.html">slicing</a> for information about available selections.</p>
</div>
</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/Apollo3zehn/PureHDF/blob/master/doc/writing/index.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright © 2024 Vincent Wilms
        </div>
      </div>
    </footer>
  </body>
</html>